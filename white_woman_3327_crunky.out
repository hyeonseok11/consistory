
Loading configuration from /home/hyeonseok/MLLM-bias/consistory/config/condition_0/config_3_white.yaml

Overriding person concept: '${PERSON_CONCEPT}' -> 'white woman'

Overriding hair concept: '${HAIR_CONCEPT}' -> 'long hair'
Output directory set to: dataset/white_woman/condition_0/spare

=== Configuration ===
condition: 0
config: config_3_white.yaml
concept_override: white woman
hair_override: long hair
run_type: batch
gpu: 0
seed: 40
mask_dropout: 0.4
same_latent: False
style: A photo of
subject: good-looking white woman
concept_token: ['good-looking', 'white woman', '30 years old', 'long hair']
settings: None
cache_cpu_offloading: False
out_dir: dataset/white_woman/condition_0/spare
clip_threshold: 0.28
===================

{'group_1': {'settings': ['who is 30 years old, with long hair, with whiteboard in study area, hands down.', 'who is 30 years old, with long hair, with whiteboard in background, hands down.', 'who is 30 years old, with long hair, with whiteboard in innovation lab, hands down.', 'who is 30 years old, with long hair, with whiteboard in office space, hands down.', 'who is 30 years old, with long hair, with whiteboard in meeting area, hands down.', 'who is 30 years old, with long hair, with whiteboard in office, hands down.', 'who is 30 years old, with long hair, with whiteboard in conference room, hands down.', 'who is 30 years old, with long hair, with whiteboard in classroom, hands down.', 'who is 30 years old, with long hair, with whiteboard in brainstorming session, hands down.']}, 'group_2': {'settings': ['who is 30 years old, with long hair, wearing casual wear, on a park bench, hands down.', 'who is 30 years old, with long hair, wearing relaxed attire, in a park, hands down.', 'who is 30 years old, with long hair, wearing casual outfit, sitting in a park, hands down.', 'who is 30 years old, with long hair, wearing casual clothing, at a park, hands down.', 'who is 30 years old, with long hair, wearing relaxed clothes, in a green space, hands down.', 'who is 30 years old, with long hair, wearing informal outfit, at a public park, hands down.', 'who is 30 years old, with long hair, wearing leisure attire, in an outdoor park, hands down.', 'who is 30 years old, with long hair, wearing everyday garments, at a local park, hands down.', 'who is 30 years old, with long hair, wearing comfortable clothes, in a community garden, hands down.', 'who is 30 years old, with long hair, wearing laid-back attire, at a neighborhood park, hands down.', 'who is 30 years old, with long hair, wearing easygoing outfit, in a park playground, hands down.']}, 'group_3': {'settings': ['who is 30 years old, with long hair, wearing casual cycling gear, cycling through a tree-lined avenue', 'who is 30 years old, with long hair, wearing casual cycling gear, cycling through a canopy of trees', 'who is 30 years old, with long hair, wearing casual cycling gear, cycling on a misty mountain trail', 'who is 30 years old, with long hair, wearing casual cycling gear, biking along a scenic coastal road', 'who is 30 years old, with long hair, wearing casual cycling gear, pedaling across a rustic wooden bridge', 'who is 30 years old, with long hair, wearing casual cycling gear, cycling through a vibrant autumn forest', 'who is 30 years old, with long hair, wearing casual cycling gear, riding along a winding riverside path', 'who is 30 years old, with long hair, wearing casual cycling gear, biking through a sunlit meadow', 'who is 30 years old, with long hair, wearing casual cycling gear, cycling past a series of picturesque vineyards']}, 'group_4': {'settings': ['who is 30 years old, with long hair, wearing casual golf attire, standing on a golf course with clubs', 'who is 30 years old, with long hair, wearing casual golf attire, at a golf course with equipment', 'who is 30 years old, with long hair, wearing casual golf attire, on the fairway with golf gear', 'who is 30 years old, with long hair, wearing casual golf attire, near the green with golf bag', 'who is 30 years old, with long hair, wearing casual golf attire, by the tee with golf accessories', 'who is 30 years old, with long hair, wearing casual golf attire, at the driving range with clubs', 'who is 30 years old, with long hair, wearing casual golf attire, on the putting green with gear', 'who is 30 years old, with long hair, wearing casual golf attire, near the clubhouse with golf bag', 'who is 30 years old, with long hair, wearing casual golf attire, on the course with golf equipment', 'who is 30 years old, with long hair, wearing casual golf attire, by the golf cart with clubs']}}
Loading pipeline components...:   0%|          | 0/7 [00:00<?, ?it/s]Loading pipeline components...:  43%|████▎     | 3/7 [00:00<00:00, 13.48it/s]Loading pipeline components...:  71%|███████▏  | 5/7 [00:00<00:00, 15.58it/s]Loading pipeline components...: 100%|██████████| 7/7 [00:00<00:00, 10.52it/s]Loading pipeline components...: 100%|██████████| 7/7 [00:00<00:00, 11.50it/s]

Processing group: group_1
  0%|          | 0/50 [00:00<?, ?it/s]/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/diffusers/utils/torch_utils.py:106: UserWarning: ComplexHalf support is experimental and many operators don't support it yet. (Triggered internally at /opt/conda/conda-bld/pytorch_1695392067780/work/aten/src/ATen/EmptyTensor.cpp:31.)
  x_freq = fftn(x, dim=(-2, -1))
  2%|▏         | 1/50 [00:10<08:12, 10.05s/it]  4%|▍         | 2/50 [00:13<05:00,  6.25s/it]  6%|▌         | 3/50 [00:17<03:55,  5.01s/it]  8%|▊         | 4/50 [00:20<03:24,  4.44s/it] 10%|█         | 5/50 [00:24<03:05,  4.12s/it] 12%|█▏        | 6/50 [00:28<03:06,  4.24s/it] 14%|█▍        | 7/50 [00:30<02:29,  3.47s/it] 16%|█▌        | 8/50 [00:32<02:04,  2.97s/it] 18%|█▊        | 9/50 [00:34<01:48,  2.64s/it] 20%|██        | 10/50 [00:36<01:41,  2.54s/it] 22%|██▏       | 11/50 [00:39<01:41,  2.59s/it] 24%|██▍       | 12/50 [00:42<01:40,  2.63s/it] 26%|██▌       | 13/50 [00:44<01:38,  2.66s/it] 28%|██▊       | 14/50 [00:46<01:28,  2.45s/it] 30%|███       | 15/50 [00:50<01:39,  2.84s/it] 32%|███▏      | 16/50 [00:53<01:35,  2.80s/it] 34%|███▍      | 17/50 [00:56<01:31,  2.77s/it] 36%|███▌      | 18/50 [00:58<01:28,  2.76s/it] 38%|███▊      | 19/50 [01:01<01:25,  2.75s/it] 40%|████      | 20/50 [01:04<01:22,  2.74s/it] 42%|████▏     | 21/50 [01:06<01:19,  2.73s/it] 44%|████▍     | 22/50 [01:08<01:09,  2.48s/it] 46%|████▌     | 23/50 [01:10<01:02,  2.31s/it] 48%|████▊     | 24/50 [01:12<00:56,  2.19s/it] 50%|█████     | 25/50 [01:14<00:52,  2.10s/it] 52%|█████▏    | 26/50 [01:16<00:49,  2.04s/it] 54%|█████▍    | 27/50 [01:18<00:46,  2.00s/it] 56%|█████▌    | 28/50 [01:20<00:43,  1.97s/it] 58%|█████▊    | 29/50 [01:22<00:41,  1.95s/it] 60%|██████    | 30/50 [01:24<00:38,  1.94s/it] 62%|██████▏   | 31/50 [01:26<00:36,  1.93s/it] 64%|██████▍   | 32/50 [01:27<00:34,  1.92s/it] 66%|██████▌   | 33/50 [01:29<00:32,  1.93s/it] 68%|██████▊   | 34/50 [01:31<00:30,  1.92s/it] 70%|███████   | 35/50 [01:33<00:28,  1.92s/it] 72%|███████▏  | 36/50 [01:35<00:26,  1.92s/it] 74%|███████▍  | 37/50 [01:37<00:24,  1.92s/it] 76%|███████▌  | 38/50 [01:39<00:22,  1.92s/it] 78%|███████▊  | 39/50 [01:41<00:21,  1.92s/it] 80%|████████  | 40/50 [01:43<00:19,  1.92s/it] 82%|████████▏ | 41/50 [01:45<00:17,  1.92s/it] 84%|████████▍ | 42/50 [01:47<00:15,  1.92s/it] 86%|████████▌ | 43/50 [01:49<00:13,  1.92s/it] 88%|████████▊ | 44/50 [01:50<00:11,  1.92s/it] 90%|█████████ | 45/50 [01:52<00:09,  1.92s/it] 92%|█████████▏| 46/50 [01:54<00:07,  1.92s/it] 94%|█████████▍| 47/50 [01:56<00:05,  1.92s/it] 96%|█████████▌| 48/50 [01:58<00:03,  1.92s/it] 98%|█████████▊| 49/50 [02:00<00:01,  1.92s/it]100%|██████████| 50/50 [02:02<00:00,  1.92s/it]100%|██████████| 50/50 [02:02<00:00,  2.45s/it]
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:04<03:27,  4.24s/it]  4%|▍         | 2/50 [00:07<03:04,  3.84s/it]  6%|▌         | 3/50 [00:11<02:54,  3.71s/it]  8%|▊         | 4/50 [00:14<02:48,  3.65s/it] 10%|█         | 5/50 [00:18<02:43,  3.62s/it] 12%|█▏        | 6/50 [00:22<02:40,  3.64s/it] 14%|█▍        | 7/50 [00:24<02:13,  3.09s/it] 16%|█▌        | 8/50 [00:26<01:54,  2.74s/it] 18%|█▊        | 9/50 [00:28<01:42,  2.50s/it] 20%|██        | 10/50 [00:30<01:33,  2.34s/it] 22%|██▏       | 11/50 [00:33<01:41,  2.60s/it] 24%|██▍       | 12/50 [00:35<01:40,  2.63s/it] 26%|██▌       | 13/50 [00:38<01:38,  2.66s/it] 28%|██▊       | 14/50 [00:41<01:36,  2.67s/it] 30%|███       | 15/50 [00:44<01:33,  2.68s/it] 32%|███▏      | 16/50 [00:46<01:31,  2.69s/it] 34%|███▍      | 17/50 [00:49<01:29,  2.70s/it] 36%|███▌      | 18/50 [00:52<01:26,  2.70s/it] 38%|███▊      | 19/50 [00:54<01:23,  2.68s/it] 40%|████      | 20/50 [00:57<01:20,  2.69s/it] 42%|████▏     | 21/50 [01:00<01:18,  2.69s/it] 44%|████▍     | 22/50 [01:02<01:08,  2.46s/it] 46%|████▌     | 23/50 [01:04<01:01,  2.29s/it] 48%|████▊     | 24/50 [01:06<00:56,  2.18s/it] 50%|█████     | 25/50 [01:07<00:52,  2.10s/it] 52%|█████▏    | 26/50 [01:09<00:49,  2.05s/it] 54%|█████▍    | 27/50 [01:11<00:46,  2.01s/it] 56%|█████▌    | 28/50 [01:13<00:43,  1.98s/it] 58%|█████▊    | 29/50 [01:15<00:41,  1.96s/it] 60%|██████    | 30/50 [01:17<00:38,  1.95s/it] 62%|██████▏   | 31/50 [01:19<00:36,  1.94s/it] 64%|██████▍   | 32/50 [01:21<00:34,  1.93s/it] 66%|██████▌   | 33/50 [01:23<00:32,  1.93s/it] 68%|██████▊   | 34/50 [01:25<00:30,  1.92s/it] 70%|███████   | 35/50 [01:27<00:28,  1.92s/it] 72%|███████▏  | 36/50 [01:29<00:26,  1.92s/it] 74%|███████▍  | 37/50 [01:30<00:24,  1.92s/it] 76%|███████▌  | 38/50 [01:32<00:23,  1.92s/it] 78%|███████▊  | 39/50 [01:34<00:21,  1.92s/it] 80%|████████  | 40/50 [01:36<00:19,  1.92s/it] 82%|████████▏ | 41/50 [01:38<00:17,  1.92s/it] 84%|████████▍ | 42/50 [01:40<00:15,  1.92s/it] 86%|████████▌ | 43/50 [01:42<00:13,  1.92s/it] 88%|████████▊ | 44/50 [01:44<00:11,  1.92s/it] 90%|█████████ | 45/50 [01:46<00:09,  1.92s/it] 92%|█████████▏| 46/50 [01:48<00:07,  1.92s/it] 94%|█████████▍| 47/50 [01:50<00:05,  1.92s/it] 96%|█████████▌| 48/50 [01:52<00:03,  1.92s/it] 98%|█████████▊| 49/50 [01:53<00:01,  1.93s/it]100%|██████████| 50/50 [01:55<00:00,  1.93s/it]100%|██████████| 50/50 [01:55<00:00,  2.32s/it]
Image 0 CLIP score: 0.291748046875
PASS
All criteria met
Image 1 CLIP score: 0.294189453125
PASS
All criteria met
Image 2 CLIP score: 0.31884765625
PASS
All criteria met
Image 3 CLIP score: 0.279296875
Image 4 CLIP score: 0.296142578125
PASS
All criteria met
Image 5 CLIP score: 0.31787109375
PASS
All criteria met
Image 6 CLIP score: 0.29150390625
PASS
All criteria met
Image 7 CLIP score: 0.33447265625
FAIL: THE IMAGE SHOWS THE WOMAN'S HANDS DISTORTED AND ELONGATED, WITH AN UNNATURAL BEND. THE HAND ON THE WHITEBOARD APPEARS DISJOINTED, AND THE FINGERS LOOK UNUSUALLY LONG AND FUSED. THERE ARE ALSO SOME MINOR ISSUES WITH THE ALIGNMENT OF THE ARMS.
Image 8 CLIP score: 0.3115234375
PASS
All criteria met
Attempt 1: 2 images below threshold. Retrying with mask_dropout: 0.35
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<02:26,  3.00s/it]  4%|▍         | 2/50 [00:07<02:52,  3.60s/it]  6%|▌         | 3/50 [00:08<02:08,  2.73s/it]  8%|▊         | 4/50 [00:11<02:05,  2.72s/it] 10%|█         | 5/50 [00:12<01:31,  2.03s/it] 12%|█▏        | 6/50 [00:13<01:17,  1.76s/it] 14%|█▍        | 7/50 [00:16<01:29,  2.08s/it] 16%|█▌        | 8/50 [00:18<01:36,  2.29s/it] 18%|█▊        | 9/50 [00:21<01:39,  2.42s/it] 20%|██        | 10/50 [00:24<01:40,  2.52s/it] 22%|██▏       | 11/50 [00:27<01:40,  2.58s/it] 24%|██▍       | 12/50 [00:29<01:39,  2.62s/it] 26%|██▌       | 13/50 [00:32<01:37,  2.64s/it] 28%|██▊       | 14/50 [00:35<01:35,  2.66s/it] 30%|███       | 15/50 [00:38<01:34,  2.71s/it] 32%|███▏      | 16/50 [00:40<01:31,  2.70s/it] 34%|███▍      | 17/50 [00:43<01:29,  2.70s/it] 36%|███▌      | 18/50 [00:46<01:26,  2.71s/it] 38%|███▊      | 19/50 [00:48<01:23,  2.71s/it] 40%|████      | 20/50 [00:51<01:21,  2.71s/it] 42%|████▏     | 21/50 [00:54<01:18,  2.71s/it] 44%|████▍     | 22/50 [00:56<01:15,  2.71s/it] 46%|████▌     | 23/50 [00:59<01:13,  2.71s/it] 48%|████▊     | 24/50 [01:02<01:10,  2.71s/it] 50%|█████     | 25/50 [01:05<01:07,  2.72s/it] 52%|█████▏    | 26/50 [01:07<01:05,  2.72s/it] 54%|█████▍    | 27/50 [01:10<01:02,  2.72s/it] 56%|█████▌    | 28/50 [01:13<00:59,  2.71s/it] 58%|█████▊    | 29/50 [01:15<00:56,  2.71s/it] 60%|██████    | 30/50 [01:18<00:54,  2.71s/it] 62%|██████▏   | 31/50 [01:21<00:51,  2.71s/it] 64%|██████▍   | 32/50 [01:24<00:48,  2.71s/it] 66%|██████▌   | 33/50 [01:26<00:46,  2.71s/it] 68%|██████▊   | 34/50 [01:29<00:43,  2.71s/it] 70%|███████   | 35/50 [01:32<00:40,  2.71s/it] 72%|███████▏  | 36/50 [01:34<00:37,  2.71s/it] 74%|███████▍  | 37/50 [01:37<00:35,  2.71s/it] 76%|███████▌  | 38/50 [01:40<00:32,  2.71s/it] 78%|███████▊  | 39/50 [01:43<00:29,  2.71s/it] 80%|████████  | 40/50 [01:45<00:27,  2.71s/it] 82%|████████▏ | 41/50 [01:48<00:24,  2.71s/it] 84%|████████▍ | 42/50 [01:51<00:21,  2.71s/it] 86%|████████▌ | 43/50 [01:53<00:18,  2.71s/it] 88%|████████▊ | 44/50 [01:56<00:16,  2.71s/it] 90%|█████████ | 45/50 [01:59<00:13,  2.71s/it] 92%|█████████▏| 46/50 [02:02<00:10,  2.71s/it] 94%|█████████▍| 47/50 [02:04<00:08,  2.71s/it] 96%|█████████▌| 48/50 [02:07<00:05,  2.71s/it] 98%|█████████▊| 49/50 [02:10<00:02,  2.71s/it]100%|██████████| 50/50 [02:12<00:00,  2.72s/it]100%|██████████| 50/50 [02:12<00:00,  2.66s/it]
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:37,  1.32it/s]  4%|▍         | 2/50 [00:01<00:37,  1.27it/s]  6%|▌         | 3/50 [00:02<00:37,  1.25it/s]  8%|▊         | 4/50 [00:03<00:36,  1.25it/s] 10%|█         | 5/50 [00:03<00:36,  1.24it/s] 12%|█▏        | 6/50 [00:04<00:35,  1.23it/s] 14%|█▍        | 7/50 [00:05<00:29,  1.45it/s] 16%|█▌        | 8/50 [00:05<00:25,  1.63it/s] 18%|█▊        | 9/50 [00:06<00:22,  1.79it/s] 20%|██        | 10/50 [00:06<00:20,  1.91it/s] 22%|██▏       | 11/50 [00:07<00:19,  2.00it/s] 24%|██▍       | 12/50 [00:07<00:18,  2.07it/s] 26%|██▌       | 13/50 [00:07<00:17,  2.12it/s] 28%|██▊       | 14/50 [00:08<00:16,  2.16it/s] 30%|███       | 15/50 [00:08<00:16,  2.19it/s] 32%|███▏      | 16/50 [00:09<00:15,  2.20it/s] 34%|███▍      | 17/50 [00:09<00:14,  2.22it/s] 36%|███▌      | 18/50 [00:10<00:14,  2.25it/s] 38%|███▊      | 19/50 [00:10<00:13,  2.27it/s] 40%|████      | 20/50 [00:10<00:13,  2.29it/s] 42%|████▏     | 21/50 [00:11<00:12,  2.30it/s] 44%|████▍     | 22/50 [00:11<00:12,  2.31it/s] 46%|████▌     | 23/50 [00:12<00:11,  2.31it/s] 48%|████▊     | 24/50 [00:12<00:11,  2.31it/s] 50%|█████     | 25/50 [00:13<00:10,  2.32it/s] 52%|█████▏    | 26/50 [00:13<00:10,  2.32it/s] 54%|█████▍    | 27/50 [00:14<00:09,  2.32it/s] 56%|█████▌    | 28/50 [00:14<00:09,  2.32it/s] 58%|█████▊    | 29/50 [00:14<00:09,  2.32it/s] 60%|██████    | 30/50 [00:15<00:08,  2.32it/s] 62%|██████▏   | 31/50 [00:15<00:08,  2.32it/s] 64%|██████▍   | 32/50 [00:16<00:07,  2.32it/s] 66%|██████▌   | 33/50 [00:16<00:07,  2.32it/s] 68%|██████▊   | 34/50 [00:17<00:06,  2.32it/s] 70%|███████   | 35/50 [00:17<00:06,  2.32it/s] 72%|███████▏  | 36/50 [00:17<00:06,  2.32it/s] 74%|███████▍  | 37/50 [00:18<00:05,  2.32it/s] 76%|███████▌  | 38/50 [00:18<00:05,  2.32it/s] 78%|███████▊  | 39/50 [00:19<00:04,  2.33it/s] 80%|████████  | 40/50 [00:19<00:04,  2.33it/s] 82%|████████▏ | 41/50 [00:20<00:03,  2.33it/s] 84%|████████▍ | 42/50 [00:20<00:03,  2.33it/s] 86%|████████▌ | 43/50 [00:20<00:02,  2.34it/s] 88%|████████▊ | 44/50 [00:21<00:02,  2.33it/s] 90%|█████████ | 45/50 [00:21<00:02,  2.34it/s] 92%|█████████▏| 46/50 [00:22<00:01,  2.33it/s] 94%|█████████▍| 47/50 [00:22<00:01,  2.34it/s] 96%|█████████▌| 48/50 [00:23<00:00,  2.34it/s] 98%|█████████▊| 49/50 [00:23<00:00,  2.33it/s]100%|██████████| 50/50 [00:23<00:00,  2.33it/s]100%|██████████| 50/50 [00:23<00:00,  2.09it/s]
Image 3 CLIP score: 0.298583984375
PASS
All criteria met
Image 7 CLIP score: 0.328369140625
PASS
All criteria met
Attempt 2: 0 images below threshold. Retrying with mask_dropout: 0.30
Saved image 0 with CLIP score: 0.2917 at /home/hyeonseok/MLLM-bias/consistory/dataset/white_woman/condition_0/spare/group_1_seed40_image_0.png
Saved image 1 with CLIP score: 0.2942 at /home/hyeonseok/MLLM-bias/consistory/dataset/white_woman/condition_0/spare/group_1_seed40_image_1.png
Saved image 2 with CLIP score: 0.3188 at /home/hyeonseok/MLLM-bias/consistory/dataset/white_woman/condition_0/spare/group_1_seed40_image_2.png
Saved image 3 with CLIP score: 0.2961 at /home/hyeonseok/MLLM-bias/consistory/dataset/white_woman/condition_0/spare/group_1_seed40_image_3.png
Saved image 4 with CLIP score: 0.3179 at /home/hyeonseok/MLLM-bias/consistory/dataset/white_woman/condition_0/spare/group_1_seed40_image_4.png
Saved image 5 with CLIP score: 0.2915 at /home/hyeonseok/MLLM-bias/consistory/dataset/white_woman/condition_0/spare/group_1_seed40_image_5.png
Saved image 6 with CLIP score: 0.3115 at /home/hyeonseok/MLLM-bias/consistory/dataset/white_woman/condition_0/spare/group_1_seed40_image_6.png
Saved image 7 with CLIP score: 0.2986 at /home/hyeonseok/MLLM-bias/consistory/dataset/white_woman/condition_0/spare/group_1_seed40_image_7.png
Saved image 8 with CLIP score: 0.3284 at /home/hyeonseok/MLLM-bias/consistory/dataset/white_woman/condition_0/spare/group_1_seed40_image_8.png

Processing group: group_2
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:10<08:32, 10.47s/it]  4%|▍         | 2/50 [00:14<05:30,  6.89s/it]  6%|▌         | 3/50 [00:19<04:29,  5.74s/it]  8%|▊         | 4/50 [00:23<03:59,  5.20s/it] 10%|█         | 5/50 [00:27<03:40,  4.91s/it] 12%|█▏        | 6/50 [00:32<03:27,  4.72s/it] 14%|█▍        | 7/50 [00:34<02:49,  3.94s/it] 16%|█▌        | 8/50 [00:37<02:24,  3.43s/it] 18%|█▊        | 9/50 [00:39<02:06,  3.09s/it] 20%|██        | 10/50 [00:42<02:04,  3.11s/it] 22%|██▏       | 11/50 [00:45<01:56,  2.99s/it] 24%|██▍       | 12/50 [00:47<01:50,  2.91s/it] 26%|██▌       | 13/50 [00:50<01:46,  2.87s/it] 28%|██▊       | 14/50 [00:53<01:41,  2.82s/it] 30%|███       | 15/50 [00:56<01:37,  2.79s/it] 32%|███▏      | 16/50 [00:58<01:34,  2.77s/it] 34%|███▍      | 17/50 [01:01<01:30,  2.76s/it] 36%|███▌      | 18/50 [01:04<01:27,  2.75s/it] 38%|███▊      | 19/50 [01:07<01:25,  2.75s/it] 40%|████      | 20/50 [01:09<01:22,  2.74s/it] 42%|████▏     | 21/50 [01:12<01:19,  2.73s/it] 44%|████▍     | 22/50 [01:14<01:13,  2.61s/it] 46%|████▌     | 23/50 [01:17<01:08,  2.53s/it] 48%|████▊     | 24/50 [01:19<01:04,  2.48s/it] 50%|█████     | 25/50 [01:21<01:01,  2.44s/it] 52%|█████▏    | 26/50 [01:24<00:57,  2.41s/it] 54%|█████▍    | 27/50 [01:26<00:55,  2.39s/it] 56%|█████▌    | 28/50 [01:28<00:52,  2.38s/it] 58%|█████▊    | 29/50 [01:31<00:49,  2.37s/it] 60%|██████    | 30/50 [01:33<00:47,  2.37s/it] 62%|██████▏   | 31/50 [01:36<00:44,  2.37s/it] 64%|██████▍   | 32/50 [01:38<00:42,  2.36s/it] 66%|██████▌   | 33/50 [01:40<00:40,  2.36s/it] 68%|██████▊   | 34/50 [01:43<00:37,  2.36s/it] 70%|███████   | 35/50 [01:45<00:35,  2.36s/it] 72%|███████▏  | 36/50 [01:47<00:33,  2.36s/it] 74%|███████▍  | 37/50 [01:50<00:30,  2.36s/it] 76%|███████▌  | 38/50 [01:52<00:28,  2.36s/it] 78%|███████▊  | 39/50 [01:54<00:25,  2.36s/it] 80%|████████  | 40/50 [01:57<00:23,  2.36s/it] 82%|████████▏ | 41/50 [01:59<00:21,  2.36s/it] 84%|████████▍ | 42/50 [02:01<00:18,  2.36s/it] 86%|████████▌ | 43/50 [02:04<00:16,  2.36s/it] 88%|████████▊ | 44/50 [02:06<00:14,  2.36s/it] 90%|█████████ | 45/50 [02:09<00:11,  2.36s/it] 92%|█████████▏| 46/50 [02:11<00:09,  2.36s/it] 94%|█████████▍| 47/50 [02:13<00:07,  2.36s/it] 96%|█████████▌| 48/50 [02:16<00:04,  2.36s/it] 98%|█████████▊| 49/50 [02:18<00:02,  2.36s/it]100%|██████████| 50/50 [02:20<00:00,  2.36s/it]100%|██████████| 50/50 [02:20<00:00,  2.82s/it]
Traceback (most recent call last):
  File "/home/hyeonseok/MLLM-bias/consistory/consistory_CLI.py", line 250, in <module>
    run_batch(args.gpu, args.seed, args.mask_dropout, args.same_latent, args.style,
  File "/home/hyeonseok/MLLM-bias/consistory/consistory_CLI.py", line 64, in run_batch
    images, image_all, clip_scores, validation_results = run_batch_generation(
  File "/home/hyeonseok/MLLM-bias/consistory/consistory_run.py", line 137, in run_batch_generation
    out = story_pipeline(prompt=current_prompts, generator=g, latents=latents,
  File "/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/hyeonseok/MLLM-bias/consistory/consistory_pipeline.py", line 498, in __call__
    image = self.vae.decode(latents / self.vae.config.scaling_factor, return_dict=False)[0]
  File "/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/diffusers/utils/accelerate_utils.py", line 46, in wrapper
    return method(self, *args, **kwargs)
  File "/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/diffusers/models/autoencoder_kl.py", line 318, in decode
    decoded = self._decode(z).sample
  File "/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/diffusers/models/autoencoder_kl.py", line 289, in _decode
    dec = self.decoder(z)
  File "/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/diffusers/models/vae.py", line 321, in forward
    sample = up_block(sample, latent_embeds)
  File "/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/diffusers/models/unet_2d_blocks.py", line 2535, in forward
    hidden_states = upsampler(hidden_states)
  File "/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/diffusers/models/resnet.py", line 199, in forward
    hidden_states = self.conv(hidden_states, scale)
  File "/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hyeonseok/.conda/envs/consistory/lib/python3.10/site-packages/diffusers/models/lora.py", line 228, in forward
    return F.conv2d(
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 11.00 GiB. GPU 0 has a total capacty of 47.54 GiB of which 9.52 GiB is free. Including non-PyTorch memory, this process has 38.01 GiB memory in use. Of the allocated memory 33.37 GiB is allocated by PyTorch, and 4.31 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
